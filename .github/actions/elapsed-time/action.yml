name: "Elapsed Time"
description: "Print how many seconds have elapsed since the last call"
inputs:
  statement:
    description: "Statement to print"
    required: true

  reference:
    description: "Optional unique name for the timestamp file"
    required: false
    default: "generic"

outputs:
  delta:
    description: "Time delta in seconds since last call"

runs:
  using: "composite"
  steps:
    - name: elapsed-time
      shell: bash
      run: |
        FILE=".elapsed_time_${{ inputs.reference }}"
        if [ -f "$FILE" ]; then
          last_time=$(cat "$FILE")
          current_time=$(date +%s)
          delta=$(( ${current_time:-0} - ${last_time:-0} ))
          echo "Elapsed time for ${{ inputs.statement }}: $delta seconds"
        else
          echo "Elapsed time for ${{ inputs.statement }}: 0 seconds"
        fi

        # Overwrite the timestamp file for next time
        FILE=".elapsed_time_${{ inputs.reference }}"
        echo "$current_time" > "$FILE"
